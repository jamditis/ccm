<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Kit Builder | Center for Cooperative Media</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & DOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- PDF Lib -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <!-- Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Serif+Display&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['DM Sans', 'sans-serif'],
                        'serif': ['DM Serif Display', 'serif'],
                        'mono': ['Space Mono', 'monospace'],
                    },
                    colors: {
                        primary: {
                            50: '#faf5ff',
                            100: '#f3e8ff',
                            200: '#e9d5ff',
                            300: '#d8b4fe',
                            400: '#c084fc',
                            500: '#a855f7',
                            600: '#9333ea',
                            700: '#7e22ce',
                            800: '#6b21a8',
                            900: '#581c87',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.4s ease-out forwards',
                        'slide-in': 'slideIn 0.3s ease-out forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideIn: {
                            '0%': { opacity: '0', transform: 'translateX(-10px)' },
                            '100%': { opacity: '1', transform: 'translateX(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background: #f8fafc;
            font-family: 'DM Sans', sans-serif;
        }

        .input-field {
            @apply w-full px-3 py-2.5 bg-white border border-gray-200 rounded-lg text-sm transition-all;
        }
        .input-field:focus {
            @apply outline-none border-primary-500 ring-2 ring-primary-500/20;
        }

        .section-card {
            @apply bg-white rounded-xl border border-gray-100 overflow-hidden;
        }

        .section-header {
            @apply px-4 py-3 bg-gray-50 border-b border-gray-100 flex items-center justify-between cursor-pointer hover:bg-gray-100 transition-colors;
        }

        .btn {
            @apply px-4 py-2 rounded-lg font-medium text-sm transition-all;
        }
        .btn-primary {
            @apply bg-primary-600 text-white hover:bg-primary-700;
        }
        .btn-secondary {
            @apply bg-gray-100 text-gray-700 hover:bg-gray-200;
        }

        /* Custom scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 3px; }

        /* Print styles */
        @media print {
            body { background: white; }
            .no-print { display: none !important; }
            .print-container { box-shadow: none !important; }
        }

        /* Mobile */
        @media screen and (max-width: 768px) {
            input, select, textarea { font-size: 16px !important; }
        }
    </style>
</head>
<body class="min-h-screen">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONS ---
        const IconFileText = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>;
        const IconChevronDown = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 12 15 18 9"/></svg>;
        const IconPlus = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
        const IconTrash = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>;
        const IconDownload = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>;
        const IconSave = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>;
        const IconEye = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>;
        const IconEdit = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>;

        const MediaKitBuilder = () => {
            // --- STATE ---
            const [activeTab, setActiveTab] = useState('editor');
            const [expandedSections, setExpandedSections] = useState(['organization', 'audience', 'platforms']);

            const [organization, setOrganization] = useState({
                name: '',
                logo: null,
                tagline: '',
                mission: '',
                foundedYear: new Date().getFullYear(),
                website: '',
                contact: { name: '', email: '', phone: '' }
            });

            const [audience, setAudience] = useState({
                totalReach: 0,
                demographics: {
                    ageRanges: [
                        { range: '18-24', percentage: 15 },
                        { range: '25-34', percentage: 30 },
                        { range: '35-44', percentage: 25 },
                        { range: '45-54', percentage: 18 },
                        { range: '55+', percentage: 12 },
                    ],
                    locations: [
                        { area: '', percentage: 0 }
                    ],
                    interests: []
                }
            });

            const [platforms, setPlatforms] = useState([
                {
                    id: 1,
                    name: 'Website',
                    enabled: true,
                    metrics: [
                        { label: 'Monthly Visitors', value: '' },
                        { label: 'Page Views', value: '' },
                        { label: 'Avg. Time on Site', value: '' }
                    ],
                    adOptions: [
                        { name: 'Leaderboard (728x90)', description: 'Top of page banner', rate: '', specs: 'JPG/PNG/GIF, max 150KB' }
                    ]
                },
                {
                    id: 2,
                    name: 'Newsletter',
                    enabled: true,
                    metrics: [
                        { label: 'Subscribers', value: '' },
                        { label: 'Open Rate', value: '' },
                        { label: 'Click Rate', value: '' }
                    ],
                    adOptions: [
                        { name: 'Sponsored Section', description: 'Dedicated sponsor message', rate: '', specs: '150 words + image' }
                    ]
                },
                {
                    id: 3,
                    name: 'Social Media',
                    enabled: false,
                    metrics: [
                        { label: 'Total Followers', value: '' },
                        { label: 'Engagement Rate', value: '' }
                    ],
                    adOptions: [
                        { name: 'Sponsored Post', description: 'Native social content', rate: '', specs: 'Platform-specific' }
                    ]
                },
                {
                    id: 4,
                    name: 'Podcast',
                    enabled: false,
                    metrics: [
                        { label: 'Downloads/Episode', value: '' },
                        { label: 'Total Episodes', value: '' }
                    ],
                    adOptions: [
                        { name: 'Pre-roll (30s)', description: 'Beginning of episode', rate: '', specs: 'Host-read or produced' },
                        { name: 'Mid-roll (60s)', description: 'Middle of episode', rate: '', specs: 'Host-read or produced' }
                    ]
                }
            ]);

            const [testimonials, setTestimonials] = useState([]);

            const [theme, setTheme] = useState({
                primaryColor: '#9333ea',
                accentColor: '#f59e0b',
                fontStyle: 'modern'
            });

            const [profiles, setProfiles] = useState([]);
            const [isGenerating, setIsGenerating] = useState(false);

            // --- EFFECTS ---
            useEffect(() => {
                const saved = localStorage.getItem('media_kit_profiles');
                if (saved) setProfiles(JSON.parse(saved));

                // Handle responsive tab switching
                const handleResize = () => {
                    if (window.innerWidth >= 1024) {
                        setActiveTab('split');
                    } else if (activeTab === 'split') {
                        setActiveTab('editor');
                    }
                };
                window.addEventListener('resize', handleResize);
                handleResize();
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            // --- HANDLERS ---
            const toggleSection = (section) => {
                setExpandedSections(prev =>
                    prev.includes(section)
                        ? prev.filter(s => s !== section)
                        : [...prev, section]
                );
            };

            const handleLogoUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => setOrganization(prev => ({ ...prev, logo: reader.result }));
                    reader.readAsDataURL(file);
                }
            };

            const updateAgeRange = (index, field, value) => {
                const updated = [...audience.demographics.ageRanges];
                updated[index] = { ...updated[index], [field]: field === 'percentage' ? parseInt(value) || 0 : value };
                setAudience(prev => ({
                    ...prev,
                    demographics: { ...prev.demographics, ageRanges: updated }
                }));
            };

            const updateLocation = (index, field, value) => {
                const updated = [...audience.demographics.locations];
                updated[index] = { ...updated[index], [field]: field === 'percentage' ? parseInt(value) || 0 : value };
                setAudience(prev => ({
                    ...prev,
                    demographics: { ...prev.demographics, locations: updated }
                }));
            };

            const addLocation = () => {
                setAudience(prev => ({
                    ...prev,
                    demographics: {
                        ...prev.demographics,
                        locations: [...prev.demographics.locations, { area: '', percentage: 0 }]
                    }
                }));
            };

            const removeLocation = (index) => {
                setAudience(prev => ({
                    ...prev,
                    demographics: {
                        ...prev.demographics,
                        locations: prev.demographics.locations.filter((_, i) => i !== index)
                    }
                }));
            };

            const togglePlatform = (id) => {
                setPlatforms(prev => prev.map(p =>
                    p.id === id ? { ...p, enabled: !p.enabled } : p
                ));
            };

            const updatePlatformMetric = (platformId, metricIndex, value) => {
                setPlatforms(prev => prev.map(p => {
                    if (p.id === platformId) {
                        const metrics = [...p.metrics];
                        metrics[metricIndex] = { ...metrics[metricIndex], value };
                        return { ...p, metrics };
                    }
                    return p;
                }));
            };

            const updateAdOption = (platformId, optionIndex, field, value) => {
                setPlatforms(prev => prev.map(p => {
                    if (p.id === platformId) {
                        const adOptions = [...p.adOptions];
                        adOptions[optionIndex] = { ...adOptions[optionIndex], [field]: value };
                        return { ...p, adOptions };
                    }
                    return p;
                }));
            };

            const addAdOption = (platformId) => {
                setPlatforms(prev => prev.map(p => {
                    if (p.id === platformId) {
                        return {
                            ...p,
                            adOptions: [...p.adOptions, { name: '', description: '', rate: '', specs: '' }]
                        };
                    }
                    return p;
                }));
            };

            const removeAdOption = (platformId, optionIndex) => {
                setPlatforms(prev => prev.map(p => {
                    if (p.id === platformId) {
                        return {
                            ...p,
                            adOptions: p.adOptions.filter((_, i) => i !== optionIndex)
                        };
                    }
                    return p;
                }));
            };

            const addTestimonial = () => {
                setTestimonials([...testimonials, { id: Date.now(), quote: '', source: '' }]);
            };

            const updateTestimonial = (id, field, value) => {
                setTestimonials(prev => prev.map(t =>
                    t.id === id ? { ...t, [field]: value } : t
                ));
            };

            const removeTestimonial = (id) => {
                setTestimonials(prev => prev.filter(t => t.id !== id));
            };

            const saveProfile = () => {
                const name = prompt("Profile name:");
                if (!name) return;
                const profile = {
                    id: Date.now(),
                    name,
                    data: { organization, audience, platforms, testimonials, theme }
                };
                const updated = [...profiles, profile];
                setProfiles(updated);
                localStorage.setItem('media_kit_profiles', JSON.stringify(updated));
            };

            const loadProfile = (profileId) => {
                const profile = profiles.find(p => p.id === Number(profileId));
                if (profile) {
                    setOrganization(profile.data.organization);
                    setAudience(profile.data.audience);
                    setPlatforms(profile.data.platforms);
                    setTestimonials(profile.data.testimonials || []);
                    if (profile.data.theme) setTheme(profile.data.theme);
                }
            };

            const handleDownload = () => {
                setIsGenerating(true);
                const element = document.getElementById('media-kit-preview');
                const opt = {
                    margin: 0.5,
                    filename: `${organization.name || 'Media'}_Kit.pdf`,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2, useCORS: true },
                    jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
                };
                html2pdf().set(opt).from(element).save().then(() => setIsGenerating(false));
            };

            // Collapsible Section Component
            const CollapsibleSection = ({ id, title, children }) => {
                const isExpanded = expandedSections.includes(id);
                return (
                    <div className="section-card mb-4">
                        <div className="section-header" onClick={() => toggleSection(id)}>
                            <h3 className="font-semibold text-sm text-gray-700">{title}</h3>
                            <IconChevronDown className={`text-gray-400 transition-transform ${isExpanded ? 'rotate-180' : ''}`} />
                        </div>
                        {isExpanded && <div className="p-4">{children}</div>}
                    </div>
                );
            };

            // Get enabled platforms
            const enabledPlatforms = platforms.filter(p => p.enabled);

            return (
                <div className="flex h-screen flex-col lg:flex-row">

                    {/* === EDITOR PANEL === */}
                    <div className={`w-full lg:w-[420px] xl:w-[480px] bg-white border-r border-gray-200 flex flex-col h-[calc(100%-56px)] lg:h-full ${activeTab === 'preview' ? 'hidden lg:flex' : 'flex'}`}>

                        {/* Header */}
                        <div className="p-4 border-b border-gray-100 flex items-center justify-between bg-white">
                            <div className="flex items-center gap-3">
                                <div className="w-9 h-9 bg-primary-600 rounded-lg flex items-center justify-center">
                                    <IconFileText className="text-white w-5 h-5" />
                                </div>
                                <div>
                                    <h1 className="font-bold text-gray-900">Media Kit Builder</h1>
                                    <p className="text-xs text-gray-500">Create professional press kits</p>
                                </div>
                            </div>
                            <div className="flex gap-2">
                                {profiles.length > 0 && (
                                    <select
                                        className="text-xs border border-gray-200 rounded px-2 py-1.5"
                                        onChange={(e) => loadProfile(e.target.value)}
                                        defaultValue=""
                                    >
                                        <option value="">Load...</option>
                                        {profiles.map(p => <option key={p.id} value={p.id}>{p.name}</option>)}
                                    </select>
                                )}
                                <button onClick={saveProfile} className="btn btn-secondary p-2" title="Save Profile">
                                    <IconSave />
                                </button>
                            </div>
                        </div>

                        {/* Form Content */}
                        <div className="flex-1 overflow-y-auto p-4 custom-scroll">

                            {/* Theme */}
                            <CollapsibleSection id="theme" title="Theme & Branding">
                                <div className="grid grid-cols-2 gap-3">
                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-1">Primary Color</label>
                                        <div className="flex items-center gap-2">
                                            <input
                                                type="color"
                                                className="w-8 h-8 rounded cursor-pointer"
                                                value={theme.primaryColor}
                                                onChange={(e) => setTheme({...theme, primaryColor: e.target.value})}
                                            />
                                            <input
                                                type="text"
                                                className="input-field flex-1 font-mono text-xs"
                                                value={theme.primaryColor}
                                                onChange={(e) => setTheme({...theme, primaryColor: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-1">Accent Color</label>
                                        <div className="flex items-center gap-2">
                                            <input
                                                type="color"
                                                className="w-8 h-8 rounded cursor-pointer"
                                                value={theme.accentColor}
                                                onChange={(e) => setTheme({...theme, accentColor: e.target.value})}
                                            />
                                            <input
                                                type="text"
                                                className="input-field flex-1 font-mono text-xs"
                                                value={theme.accentColor}
                                                onChange={(e) => setTheme({...theme, accentColor: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                </div>
                            </CollapsibleSection>

                            {/* Organization */}
                            <CollapsibleSection id="organization" title="Organization Profile">
                                <div className="space-y-3">
                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-1">Organization Name</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            placeholder="Your News Organization"
                                            value={organization.name}
                                            onChange={(e) => setOrganization({...organization, name: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-1">Logo</label>
                                        <label className="input-field block text-center cursor-pointer hover:bg-gray-50">
                                            <span className="text-gray-500 text-sm">{organization.logo ? 'Change Logo' : 'Upload Logo'}</span>
                                            <input type="file" accept="image/*" className="hidden" onChange={handleLogoUpload} />
                                        </label>
                                    </div>
                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-1">Tagline</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            placeholder="Your tagline or slogan"
                                            value={organization.tagline}
                                            onChange={(e) => setOrganization({...organization, tagline: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-1">Mission Statement</label>
                                        <textarea
                                            className="input-field"
                                            rows="3"
                                            placeholder="Describe your mission and values..."
                                            value={organization.mission}
                                            onChange={(e) => setOrganization({...organization, mission: e.target.value})}
                                        />
                                    </div>
                                    <div className="grid grid-cols-2 gap-3">
                                        <div>
                                            <label className="block text-xs font-medium text-gray-600 mb-1">Founded</label>
                                            <input
                                                type="number"
                                                className="input-field"
                                                value={organization.foundedYear}
                                                onChange={(e) => setOrganization({...organization, foundedYear: parseInt(e.target.value) || 2020})}
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-xs font-medium text-gray-600 mb-1">Website</label>
                                            <input
                                                type="url"
                                                className="input-field"
                                                placeholder="https://"
                                                value={organization.website}
                                                onChange={(e) => setOrganization({...organization, website: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    <div className="pt-2 border-t border-gray-100">
                                        <label className="block text-xs font-medium text-gray-600 mb-2">Contact Person</label>
                                        <div className="space-y-2">
                                            <input
                                                type="text"
                                                className="input-field"
                                                placeholder="Name"
                                                value={organization.contact.name}
                                                onChange={(e) => setOrganization({...organization, contact: {...organization.contact, name: e.target.value}})}
                                            />
                                            <div className="grid grid-cols-2 gap-2">
                                                <input
                                                    type="email"
                                                    className="input-field"
                                                    placeholder="Email"
                                                    value={organization.contact.email}
                                                    onChange={(e) => setOrganization({...organization, contact: {...organization.contact, email: e.target.value}})}
                                                />
                                                <input
                                                    type="tel"
                                                    className="input-field"
                                                    placeholder="Phone"
                                                    value={organization.contact.phone}
                                                    onChange={(e) => setOrganization({...organization, contact: {...organization.contact, phone: e.target.value}})}
                                                />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </CollapsibleSection>

                            {/* Audience */}
                            <CollapsibleSection id="audience" title="Audience Demographics">
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-1">Total Audience Reach</label>
                                        <input
                                            type="number"
                                            className="input-field"
                                            placeholder="Combined reach across all platforms"
                                            value={audience.totalReach || ''}
                                            onChange={(e) => setAudience({...audience, totalReach: parseInt(e.target.value) || 0})}
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-2">Age Distribution</label>
                                        <div className="space-y-2">
                                            {audience.demographics.ageRanges.map((range, i) => (
                                                <div key={i} className="flex items-center gap-2">
                                                    <span className="text-xs text-gray-500 w-16">{range.range}</span>
                                                    <input
                                                        type="range"
                                                        min="0"
                                                        max="100"
                                                        className="flex-1"
                                                        value={range.percentage}
                                                        onChange={(e) => updateAgeRange(i, 'percentage', e.target.value)}
                                                    />
                                                    <span className="text-xs font-mono w-10 text-right">{range.percentage}%</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-2">Geographic Distribution</label>
                                        <div className="space-y-2">
                                            {audience.demographics.locations.map((loc, i) => (
                                                <div key={i} className="flex items-center gap-2">
                                                    <input
                                                        type="text"
                                                        className="input-field flex-1"
                                                        placeholder="City/Region"
                                                        value={loc.area}
                                                        onChange={(e) => updateLocation(i, 'area', e.target.value)}
                                                    />
                                                    <input
                                                        type="number"
                                                        className="input-field w-20"
                                                        placeholder="%"
                                                        value={loc.percentage || ''}
                                                        onChange={(e) => updateLocation(i, 'percentage', e.target.value)}
                                                    />
                                                    {audience.demographics.locations.length > 1 && (
                                                        <button onClick={() => removeLocation(i)} className="text-gray-400 hover:text-red-500">
                                                            <IconTrash />
                                                        </button>
                                                    )}
                                                </div>
                                            ))}
                                            <button
                                                onClick={addLocation}
                                                className="text-xs text-primary-600 hover:text-primary-700 flex items-center gap-1"
                                            >
                                                <IconPlus /> Add Location
                                            </button>
                                        </div>
                                    </div>

                                    <div>
                                        <label className="block text-xs font-medium text-gray-600 mb-1">Audience Interests</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            placeholder="Comma-separated: Local news, Politics, Business..."
                                            value={audience.demographics.interests.join(', ')}
                                            onChange={(e) => setAudience({
                                                ...audience,
                                                demographics: {
                                                    ...audience.demographics,
                                                    interests: e.target.value.split(',').map(s => s.trim()).filter(Boolean)
                                                }
                                            })}
                                        />
                                    </div>
                                </div>
                            </CollapsibleSection>

                            {/* Platforms */}
                            <CollapsibleSection id="platforms" title="Platforms & Ad Rates">
                                <div className="space-y-4">
                                    {platforms.map(platform => (
                                        <div key={platform.id} className={`border rounded-lg ${platform.enabled ? 'border-primary-200 bg-primary-50/30' : 'border-gray-200'}`}>
                                            <div className="p-3 flex items-center justify-between">
                                                <label className="flex items-center gap-2 cursor-pointer">
                                                    <input
                                                        type="checkbox"
                                                        checked={platform.enabled}
                                                        onChange={() => togglePlatform(platform.id)}
                                                        className="w-4 h-4 text-primary-600 rounded"
                                                    />
                                                    <span className="font-medium text-sm">{platform.name}</span>
                                                </label>
                                            </div>

                                            {platform.enabled && (
                                                <div className="px-3 pb-3 space-y-3">
                                                    {/* Metrics */}
                                                    <div>
                                                        <span className="text-xs font-medium text-gray-500">Metrics</span>
                                                        <div className="grid grid-cols-2 gap-2 mt-1">
                                                            {platform.metrics.map((metric, i) => (
                                                                <div key={i}>
                                                                    <label className="text-[10px] text-gray-400">{metric.label}</label>
                                                                    <input
                                                                        type="text"
                                                                        className="input-field py-1.5 text-xs"
                                                                        placeholder="0"
                                                                        value={metric.value}
                                                                        onChange={(e) => updatePlatformMetric(platform.id, i, e.target.value)}
                                                                    />
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>

                                                    {/* Ad Options */}
                                                    <div>
                                                        <span className="text-xs font-medium text-gray-500">Ad Options</span>
                                                        <div className="space-y-2 mt-1">
                                                            {platform.adOptions.map((option, i) => (
                                                                <div key={i} className="bg-white p-2 rounded border border-gray-100 space-y-1">
                                                                    <div className="flex items-center gap-2">
                                                                        <input
                                                                            type="text"
                                                                            className="input-field py-1 text-xs flex-1"
                                                                            placeholder="Ad unit name"
                                                                            value={option.name}
                                                                            onChange={(e) => updateAdOption(platform.id, i, 'name', e.target.value)}
                                                                        />
                                                                        <input
                                                                            type="text"
                                                                            className="input-field py-1 text-xs w-24"
                                                                            placeholder="$000"
                                                                            value={option.rate}
                                                                            onChange={(e) => updateAdOption(platform.id, i, 'rate', e.target.value)}
                                                                        />
                                                                        {platform.adOptions.length > 1 && (
                                                                            <button onClick={() => removeAdOption(platform.id, i)} className="text-gray-400 hover:text-red-500">
                                                                                <IconTrash />
                                                                            </button>
                                                                        )}
                                                                    </div>
                                                                    <input
                                                                        type="text"
                                                                        className="input-field py-1 text-xs"
                                                                        placeholder="Description"
                                                                        value={option.description}
                                                                        onChange={(e) => updateAdOption(platform.id, i, 'description', e.target.value)}
                                                                    />
                                                                </div>
                                                            ))}
                                                            <button
                                                                onClick={() => addAdOption(platform.id)}
                                                                className="text-xs text-primary-600 hover:text-primary-700 flex items-center gap-1"
                                                            >
                                                                <IconPlus /> Add Ad Option
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </CollapsibleSection>

                            {/* Testimonials */}
                            <CollapsibleSection id="testimonials" title="Testimonials">
                                <div className="space-y-3">
                                    {testimonials.map(t => (
                                        <div key={t.id} className="bg-gray-50 p-3 rounded-lg space-y-2">
                                            <textarea
                                                className="input-field text-sm"
                                                rows="2"
                                                placeholder="Quote from advertiser or partner..."
                                                value={t.quote}
                                                onChange={(e) => updateTestimonial(t.id, 'quote', e.target.value)}
                                            />
                                            <div className="flex items-center gap-2">
                                                <input
                                                    type="text"
                                                    className="input-field flex-1"
                                                    placeholder="Source name"
                                                    value={t.source}
                                                    onChange={(e) => updateTestimonial(t.id, 'source', e.target.value)}
                                                />
                                                <button onClick={() => removeTestimonial(t.id)} className="text-gray-400 hover:text-red-500">
                                                    <IconTrash />
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                    <button
                                        onClick={addTestimonial}
                                        className="w-full py-2 border-2 border-dashed border-gray-200 rounded-lg text-xs text-gray-500 hover:border-gray-300 flex items-center justify-center gap-1"
                                    >
                                        <IconPlus /> Add Testimonial
                                    </button>
                                </div>
                            </CollapsibleSection>

                            {/* Attribution */}
                            <div className="py-4 text-center text-xs text-gray-400">
                                <p>Media Kit Builder | Â© 2025 <a href="https://centerforcooperativemedia.org/" className="hover:text-primary-600">Center for Cooperative Media</a></p>
                                <p>Created by <a href="https://twitter.com/jsamditis" className="hover:text-primary-600">Joe Amditis</a></p>
                            </div>
                        </div>
                    </div>

                    {/* === PREVIEW PANEL === */}
                    <div className={`flex-1 bg-gray-100 flex flex-col h-[calc(100%-56px)] lg:h-full ${activeTab === 'editor' ? 'hidden lg:flex' : 'flex'}`}>

                        {/* Toolbar */}
                        <div className="p-4 bg-white border-b border-gray-200 flex justify-end">
                            <button
                                onClick={handleDownload}
                                disabled={isGenerating}
                                className="btn btn-primary flex items-center gap-2"
                            >
                                {isGenerating ? 'Generating...' : <><IconDownload /> Download PDF</>}
                            </button>
                        </div>

                        {/* Preview */}
                        <div className="flex-1 overflow-auto p-6 custom-scroll">
                            <div
                                id="media-kit-preview"
                                className="bg-white shadow-lg max-w-[800px] mx-auto"
                                style={{ fontFamily: 'DM Sans, sans-serif' }}
                            >
                                {/* Header */}
                                <header
                                    className="p-8 text-white"
                                    style={{ backgroundColor: theme.primaryColor }}
                                >
                                    <div className="flex items-start justify-between">
                                        <div className="flex-1">
                                            {organization.logo && (
                                                <img src={organization.logo} alt="Logo" className="h-12 mb-4 object-contain" />
                                            )}
                                            <h1 className="text-3xl font-bold mb-1" style={{ fontFamily: 'DM Serif Display, serif' }}>
                                                {organization.name || 'Your Organization'}
                                            </h1>
                                            {organization.tagline && (
                                                <p className="text-white/80 text-sm">{organization.tagline}</p>
                                            )}
                                        </div>
                                        <div className="text-right text-sm">
                                            <p className="text-2xl font-bold mb-1" style={{ fontFamily: 'DM Serif Display, serif' }}>
                                                Media Kit
                                            </p>
                                            <p className="text-white/70">{new Date().getFullYear()}</p>
                                        </div>
                                    </div>
                                </header>

                                <div className="p-8 space-y-8">
                                    {/* Mission */}
                                    {organization.mission && (
                                        <section>
                                            <h2 className="text-lg font-bold mb-3" style={{ color: theme.primaryColor }}>About Us</h2>
                                            <p className="text-gray-600 text-sm leading-relaxed">{organization.mission}</p>
                                            {organization.foundedYear && (
                                                <p className="text-xs text-gray-400 mt-2">Est. {organization.foundedYear}</p>
                                            )}
                                        </section>
                                    )}

                                    {/* Audience */}
                                    {audience.totalReach > 0 && (
                                        <section>
                                            <h2 className="text-lg font-bold mb-4" style={{ color: theme.primaryColor }}>Our Audience</h2>

                                            <div className="text-center mb-6 p-4 rounded-lg" style={{ backgroundColor: theme.primaryColor + '10' }}>
                                                <p className="text-3xl font-bold" style={{ color: theme.primaryColor }}>
                                                    {audience.totalReach.toLocaleString()}
                                                </p>
                                                <p className="text-xs text-gray-500 uppercase tracking-wider">Total Reach</p>
                                            </div>

                                            <div className="grid grid-cols-2 gap-6">
                                                {/* Age Distribution */}
                                                <div>
                                                    <h3 className="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Age Distribution</h3>
                                                    <div className="space-y-2">
                                                        {audience.demographics.ageRanges.map((range, i) => (
                                                            <div key={i} className="flex items-center gap-2">
                                                                <span className="text-xs text-gray-500 w-12">{range.range}</span>
                                                                <div className="flex-1 bg-gray-100 rounded-full h-4 overflow-hidden">
                                                                    <div
                                                                        className="h-full rounded-full transition-all"
                                                                        style={{
                                                                            width: `${range.percentage}%`,
                                                                            backgroundColor: theme.primaryColor
                                                                        }}
                                                                    />
                                                                </div>
                                                                <span className="text-xs font-mono text-gray-600 w-8">{range.percentage}%</span>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>

                                                {/* Locations */}
                                                {audience.demographics.locations.some(l => l.area) && (
                                                    <div>
                                                        <h3 className="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Top Locations</h3>
                                                        <div className="space-y-2">
                                                            {audience.demographics.locations.filter(l => l.area).map((loc, i) => (
                                                                <div key={i} className="flex items-center justify-between">
                                                                    <span className="text-sm text-gray-700">{loc.area}</span>
                                                                    <span className="text-sm font-mono" style={{ color: theme.primaryColor }}>{loc.percentage}%</span>
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>

                                            {/* Interests */}
                                            {audience.demographics.interests.length > 0 && (
                                                <div className="mt-4">
                                                    <h3 className="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Interests</h3>
                                                    <div className="flex flex-wrap gap-2">
                                                        {audience.demographics.interests.map((interest, i) => (
                                                            <span
                                                                key={i}
                                                                className="px-2 py-1 rounded text-xs"
                                                                style={{ backgroundColor: theme.accentColor + '20', color: theme.accentColor }}
                                                            >
                                                                {interest}
                                                            </span>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}
                                        </section>
                                    )}

                                    {/* Platforms & Ad Rates */}
                                    {enabledPlatforms.length > 0 && (
                                        <section>
                                            <h2 className="text-lg font-bold mb-4" style={{ color: theme.primaryColor }}>Advertising Opportunities</h2>

                                            <div className="space-y-6">
                                                {enabledPlatforms.map(platform => (
                                                    <div key={platform.id} className="border border-gray-200 rounded-lg overflow-hidden">
                                                        <div className="px-4 py-3 font-semibold text-sm" style={{ backgroundColor: theme.primaryColor + '10', color: theme.primaryColor }}>
                                                            {platform.name}
                                                        </div>
                                                        <div className="p-4">
                                                            {/* Metrics */}
                                                            {platform.metrics.some(m => m.value) && (
                                                                <div className="flex flex-wrap gap-4 mb-4 pb-4 border-b border-gray-100">
                                                                    {platform.metrics.filter(m => m.value).map((metric, i) => (
                                                                        <div key={i}>
                                                                            <p className="text-lg font-bold" style={{ color: theme.primaryColor }}>{metric.value}</p>
                                                                            <p className="text-xs text-gray-500">{metric.label}</p>
                                                                        </div>
                                                                    ))}
                                                                </div>
                                                            )}

                                                            {/* Ad Options */}
                                                            <div className="space-y-3">
                                                                {platform.adOptions.filter(o => o.name).map((option, i) => (
                                                                    <div key={i} className="flex items-start justify-between">
                                                                        <div>
                                                                            <p className="font-medium text-sm text-gray-900">{option.name}</p>
                                                                            {option.description && (
                                                                                <p className="text-xs text-gray-500">{option.description}</p>
                                                                            )}
                                                                        </div>
                                                                        {option.rate && (
                                                                            <p className="font-bold text-sm" style={{ color: theme.accentColor }}>{option.rate}</p>
                                                                        )}
                                                                    </div>
                                                                ))}
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </section>
                                    )}

                                    {/* Testimonials */}
                                    {testimonials.length > 0 && testimonials.some(t => t.quote) && (
                                        <section>
                                            <h2 className="text-lg font-bold mb-4" style={{ color: theme.primaryColor }}>What Partners Say</h2>
                                            <div className="space-y-4">
                                                {testimonials.filter(t => t.quote).map(t => (
                                                    <blockquote key={t.id} className="border-l-4 pl-4 italic text-gray-600 text-sm" style={{ borderColor: theme.accentColor }}>
                                                        "{t.quote}"
                                                        {t.source && <footer className="mt-1 text-xs text-gray-400 not-italic">â {t.source}</footer>}
                                                    </blockquote>
                                                ))}
                                            </div>
                                        </section>
                                    )}

                                    {/* Contact */}
                                    {(organization.contact.name || organization.contact.email) && (
                                        <section className="pt-6 border-t border-gray-200">
                                            <h2 className="text-lg font-bold mb-3" style={{ color: theme.primaryColor }}>Get in Touch</h2>
                                            <div className="text-sm text-gray-600">
                                                {organization.contact.name && <p className="font-medium">{organization.contact.name}</p>}
                                                {organization.contact.email && <p>{organization.contact.email}</p>}
                                                {organization.contact.phone && <p>{organization.contact.phone}</p>}
                                                {organization.website && (
                                                    <p className="mt-2" style={{ color: theme.primaryColor }}>{organization.website}</p>
                                                )}
                                            </div>
                                        </section>
                                    )}
                                </div>

                                {/* Footer */}
                                <footer className="px-8 py-4 bg-gray-50 text-center text-xs text-gray-400">
                                    Generated with Media Kit Builder by Center for Cooperative Media
                                </footer>
                            </div>
                        </div>
                    </div>

                    {/* === MOBILE TAB BAR === */}
                    <div className="lg:hidden fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 flex h-14 z-50">
                        <button
                            onClick={() => setActiveTab('editor')}
                            className={`flex-1 flex flex-col items-center justify-center gap-1 ${activeTab === 'editor' ? 'text-primary-600' : 'text-gray-400'}`}
                        >
                            <IconEdit />
                            <span className="text-[10px] font-medium">Editor</span>
                        </button>
                        <button
                            onClick={() => setActiveTab('preview')}
                            className={`flex-1 flex flex-col items-center justify-center gap-1 ${activeTab === 'preview' ? 'text-primary-600' : 'text-gray-400'}`}
                        >
                            <IconEye />
                            <span className="text-[10px] font-medium">Preview</span>
                        </button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MediaKitBuilder />);
    </script>
</body>
</html>
